<!DOCTYPE html>
<html lang="no">
    <head>
        <title>Yo</title>
    </head>
    <body>
        <p>Hello World</p>

        <form>
            <textarea id="lenker">Legg til lenke her, separer flere linker med komma</textarea>
            <input type="text" id="html-element" placeholder="HTML Element med relevant text (CSS syntax)">
            <button type="submit" id="klikk-meg">Send data</button>
        </form>

        <p id="response"></p>
        <script>

            async  function sendData(data) {
                const url = '/keywords';
                const init = {
                    method: "POST",
                    headers: {
                            'Content-Type': 'application/json'
                        },
                    body: JSON.stringify(data)
                }

                const response = await fetch(url, init);
                const html = await response.text();

                return html
            }
        
            document.querySelector('form').addEventListener("submit", (e) => {
                e.preventDefault()
                const linksElement = document.querySelector('#lenker');
                const targetHTMLElement = document.querySelector('#html-element');
                const htmlElement = targetHTMLElement.value;
                const urls = linksElement.value.split(",");
                const data = {urls, htmlElement};

                sendData(data).then(response => {
                    document.getElementById('response').innerHTML = response;
                }).catch(err => {
                    console.error(err);
                    document.getElementById('response').innerHTML = '<p> Beklager, men noe gikk galt :( </p>';
                })
                linksElement.value = "Legg til lenke her, separer flere lenker med komma";
                targetHTMLElement.value = "";
            })
            
        </script>
    </body>
</html>